import './polyfills.server.mjs';
import{a as H}from"./chunk-VUT7OI34.mjs";import{b as J,c as B,e as m,f as s}from"./chunk-RLVMNVTV.mjs";import{a as N,b as U}from"./chunk-ZYNMR3FV.mjs";import{c as j,i as h}from"./chunk-XYF5ZNBO.mjs";import"./chunk-UBCID47O.mjs";import{a as V}from"./chunk-NJYFXIAT.mjs";import"./chunk-37SWU3SZ.mjs";import"./chunk-IQJQIJPP.mjs";import{H as D,n as R,w as L}from"./chunk-TNSAREYT.mjs";import{c as T}from"./chunk-KCQOCMHZ.mjs";import{Ab as P,Gb as O,Hb as A,Jb as I,Na as _,Ta as l,gb as x,hb as p,ia as y,ib as M,ob as S,qc as k,s as b,tb as E}from"./chunk-OUEVK6MT.mjs";import"./chunk-KRLCULJA.mjs";var G=["container"],de=(()=>{let o=class o{constructor(r,t,e,i){if(this.router=r,this.dialog=t,this.store=e,this.renderer=i,this.activityName="",this.totalActivitiesToComplete="",this.totalActivitiesCompleted="",this.totalProgress="",this.data=H(),this.data&&this.data.token){let a=this.data.userLoggedIn;this.store.dispatch(j({id:a.id,token:this.data.token}))}else typeof window<"u"&&(window.location.href="/login")}ngAfterViewInit(){b([this.store.select(J),this.store.select(B)]).subscribe(([r,t])=>{t?r&&this.createCardActivity(r):t===!1&&s(this.dialog,"UPS! \u{1F631}","Al parecer tu sesi\xF3n ha expirado. Vuelve a iniciar sesi\xF3n\u{1F644}.",!1,()=>{localStorage.clear(),sessionStorage.clear(),window.location.href="/login"})})}ngOnInit(){}goHome(){window.location.href="/dashboard"}onCardClick(){this.totalActivitiesCompleted===this.totalActivitiesToComplete?s(this.dialog,"Vaya \u{1F62E}","Parece que ya has completado todos los niveles \u{1F631}. Te avisaremos pronto cual es tu siguiente reto \u{1F920}.",!1,()=>{}):window.location.href="/activity/game-launcher"}calculatePercentage(r,t){return r/t*100}getTheNextLevel(r){return r.find(e=>!e.completed)??null}createCardActivity(r){let t=this.container?.nativeElement;t.innerHTML="",r.forEach(e=>{let i=this.renderer.createElement("div");this.renderer.addClass(i,"card");let a=this.renderer.createElement("h1");this.renderer.addClass(a,"title-card");let Q=this.renderer.createText(e.name);this.renderer.appendChild(a,Q),this.renderer.appendChild(i,a);let f=this.renderer.createElement("p");this.renderer.addClass(f,"p-levels");let F=this.renderer.createText("Completado: "+e.completed_levels+" / "+e.total_levels);this.renderer.appendChild(f,F),this.renderer.appendChild(i,f);let c=this.renderer.createElement("div");this.renderer.addClass(c,"p-data");let u=this.renderer.createElement("p");this.renderer.addClass(u,"p-text");let Y=this.renderer.createText("Progreso");this.renderer.appendChild(u,Y);let C=this.renderer.createElement("p");this.renderer.addClass(C,"p-percent");let d=this.calculatePercentage(e.completed_levels,e.total_levels),q=this.renderer.createText(d+"%");this.renderer.appendChild(C,q),this.renderer.appendChild(c,u),this.renderer.appendChild(c,C),this.renderer.appendChild(i,c);let v=this.renderer.createElement("div");this.renderer.addClass(v,"progress-bar");let w=this.renderer.createElement("div");this.renderer.addClass(w,"progress-bar-inside"),this.renderer.setStyle(w,"width",d+"%"),this.renderer.appendChild(v,w),this.renderer.appendChild(i,v),this.renderer.listen(i,"click",()=>{e.name==="MEMORAMA"?d===100?s(this.dialog,"Modo Experto \u{1F92B}.","Ya eres todo un experto en esta actividad \u{1F9D0}, por el momento no tenemos m\xE1s niveles para tu SUPER PODER \u{1F644}.",!1,()=>{}):e.completed_levels===0?(this.store.dispatch(h({id:e.activity_id,token:this.data.token})),this.store.select(m).subscribe(n=>{n&&s(this.dialog,n.data.name,n.data.description,!1,()=>{sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"})})):(sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"):e.name==="LABERINTO DE ZEN"?d===100?s(this.dialog,"Modo Experto \u{1F92B}.","Ya eres todo un experto en esta actividad \u{1F9D0}, por el momento no tenemos m\xE1s niveles para tu SUPER PODER \u{1F644}.",!1,()=>{}):e.completed_levels===0?(this.store.dispatch(h({id:e.activity_id,token:this.data.token})),this.store.select(m).subscribe(n=>{n&&s(this.dialog,n.data.name,n.data.description,!1,()=>{sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"})})):(sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"):e.name==="ARMON\xCDA DEL COLOR"?d===100?s(this.dialog,"Modo Experto \u{1F92B}.","Ya eres todo un experto en esta actividad \u{1F9D0}, por el momento no tenemos m\xE1s niveles para tu SUPER PODER \u{1F644}.",!1,()=>{}):e.completed_levels===0?(this.store.dispatch(h({id:e.activity_id,token:this.data.token})),this.store.select(m).subscribe(n=>{n&&s(this.dialog,n.data.name,n.data.description,!1,()=>{sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"})})):(sessionStorage.setItem("activity",JSON.stringify(e)),window.location.href="/activity/game-launcher"):s(this.dialog,"UPS!","Esta ACTIVIDAD se encuentra actualmente en desarrollo",!1,()=>{})}),this.renderer.appendChild(t,i)})}};o.\u0275fac=function(t){return new(t||o)(l(T),l(V),l(R),l(_))},o.\u0275cmp=y({type:o,selectors:[["app-activities"]],viewQuery:function(t,e){if(t&1&&A(G,7),t&2){let i;O(i=I())&&(e.container=i.first)}},standalone:!0,features:[P],decls:8,vars:0,consts:[[1,"w-full","h-full","p-10","bg-slate-800","overflow-auto"],[1,"w-40","mb-8"],[3,"onClick"],[1,"min-w-[1100px]","w-full","min-h-[500px]","h-fit","max-h-[800px]","p-4","bg-slate-400/80","border-2","rounded-lg","shadow-inner","grid","grid-cols-5","gap-4","overflow-auto"],["container",""]],template:function(t,e){t&1&&(x(0,"div",0)(1,"div",1)(2,"app-am-button",2),S("onClick",function(){return e.goHome()}),x(3,"mat-icon"),E(4,"navigate_before"),p(),E(5," Ir al Inicio"),p()(),M(6,"div",3,4),p())},dependencies:[k,D,L,U,N],styles:[".card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-evenly;align-items:center;width:13rem;height:13rem;border-radius:.375rem;padding:1rem;background-color:#f8fafc;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;transition-property:all;transition-duration:.3s;transition-timing-function:ease}.card[_ngcontent-%COMP%]:hover{transform:scale(1.05);cursor:pointer}.title-card[_ngcontent-%COMP%]{text-align:center;color:#1a202c;font-weight:700}.p-levels[_ngcontent-%COMP%]{text-align:center;color:#718096}.p-data[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between}.p-text[_ngcontent-%COMP%]{text-align:left}.p-percent[_ngcontent-%COMP%]{text-align:right}.progress-bar[_ngcontent-%COMP%]{border-radius:.375rem;width:100%;height:.5rem;background-color:#718096}.progress-bar-inside[_ngcontent-%COMP%]{height:100%;border-radius:.375rem;background-color:#38a169}"]});let g=o;return g})();export{de as default};
